REQUIRES: aarch64

RUN: llvm-mc -filetype=obj -triple=arm64ec-windows %S/Inputs/arm64ec-loadcfg.s -o arm64ec-loadcfg.obj

ARM64EC code is always instrumented.

RUN: lld-link -out:%t.dll -machine:arm64ec arm64ec-loadcfg.obj -dll -noentry
RUN: llvm-readobj --coff-load-config %t.dll | FileCheck %s

RUN: lld-link -out:%t.dll -machine:arm64ec arm64ec-loadcfg.obj -dll -noentry -guard:no
RUN: llvm-readobj --coff-load-config %t.dll | FileCheck %s

CHECK:       GuardFlags [ (0x100)
CHECK-NEXT:    CF_INSTRUMENTED (0x100)
CHECK-NEXT:  ]
